# 1. 列表

在日常生活中，人们经常使用列表：待办事项列表、购物清单、十佳榜单、最后十名榜单等。计算机程序也在使用列表，尤其是列表中保存的元素不是太多时。当不需要在一个很长的序列中查找元素，或者对其进行排序时，列表显得尤为有用。反之，如果数据结构非常复杂，列表的作用就没有那么大了。

本章展示了如何创建一个简单的列表类。我们首先给出列表的抽象数据类型定义，然后描述如何实现该抽象数据类型（ADT）。最后，分析几个列表适合解决的实际问题。

## 1.1. 列表 ADT

为了设计列表的抽象数据类型，需要给出列表的定义，包括列表应该拥有哪些属性，应该在列表上执行哪些操作。

列表是一组有序的数据。每个列表中的数据项称为元素。在 JavaScript 中，列表中的元素可以是任意数据类型。列表中可以保存多少元素并没有事先限定，实际使用时元素的数量受到程序内存的限制。

不包含任何元素的列表称为空列表。列表中包含元素的个数称为列表的大小。在内部实现上，用一个变量 size 保存列表中元素的个数。可以在列表末尾 append() 一个元素，也可以在一个给定元素后 insert(ele, after) 一个元素。使用 remove(ele) 方法从列表中删除元素，使用 clear() 方法清空列表中所有的元素。

列表始终有一个游标 cur，标识列表的当前位置。next() 和 pre() 方法用于将游标向后或向前移动 1 位，与此类似，front()，end()用于将游标移动到列表的第 1 个和倒数第 1 个位置，而 moveTo(n) 方法用于移动到第 n 位。

要获取当前游标所在的元素则使用 getCurEle() 方法。

## 1.2. 实现列表

```javascript
class List {
  constructor() {
    // 游标
    this.cur = 0;

    // 大小
    this.size = 0;
  }

  // 将游标移动到索引 n
  moveTo(n) {
    // 确保索引在合法范围：[0, this.size - 1]
    if (n < this.size && n >= 0) {
      this.cur = n;
    }

    return this;
  }

  // 将游标移动到下一位
  next() {
    this.moveTo(this.cur + 1);
    return this;
  }

  // 将游标移动到上一位
  pre() {
    this.moveTo(this.cur - 1);
    return this;
  }

  // 将游标移动到第 1 位
  front() {
    this.moveTo(0);
    return this;
  }

  // 将游标移动到最末尾
  end() {
    this.moveTo(this.size - 1);
    return this;
  }

  // 返回游标对应的元素
  getCurEle() {
    return this[this.cur];
  }

  // 在元素 after 后插入 eleToInsert
  insert(eleToInsert, after) {
    // 找到 after 元素，返回其索引
    const index = Object.values(this).findIndex((ele) => Object.is(ele, after));

    // 从末尾往前，将 after 后的元素整体往后移动 1 位
    for (let i = index + 1; i < this.size; i++) {
      this[i + 1] = this[i];
    }

    // 之后，将 after 后的元素更新为 eleToInsert
    this[index + 1] = eleToInsert;

    // 更新列表的大小
    this.size++;

    return this;
  }

  // 在元素末尾插入1个元素
  append(ele) {
    this[this.size] = ele;
    this.size++;
    return this;
  }

  // 移除一个元素
  remove(eleToRemove) {
    // 找到要移除的 eleToRemove 元素的索引
    const index = Object.values(this).findIndex((ele) =>
      Object.is(ele, eleToRemove),
    );

    // 删除这 eleToRemove
    delete this[index];

    // 更新列表大小
    this.size--;

    // 考虑游标在末尾的情况
    if (this.cur > this.size - 1) {
      this.cur = this.size - 1;
    }

    return this;
  }

  // 清除所有的元素
  clear() {
    for (let i = 0; i < this.size; i++) {
      delete this[i];
    }

    // 更新索引
    this.size = 0;
    this.cur = 0;

    return this;
  }
}
```

## 1.3. 使用列表

```javascript
const list = new List();

list.append('apple').append('orange').append('pear');
console.log(list);
// -> List { '0': 'apple', '1': 'orange', '2': 'pear', cur: 0, size: 3 }

list.insert('strawberry', 'apple').insert('watermelon', 'pear');
console.log(list);
/* List {
  '0': 'apple',
  '1': 'strawberry',
  '2': 'orange',
  '3': 'pear',
  '4': 'watermelon',
  cur: 0,
  size: 5
} */

console.log(list.end().pre().front().next().moveTo(0).getCurEle());
// -> 'apple'

list.remove('watermelon').remove('strawberry');
console.log(list);
// -> List { '0': 'apple', '1': 'orange', '2': 'pear', cur: 1, size: 3 }

list.clear();
console.log(list);
// -> List { cur: 0, size: 0 }
```
